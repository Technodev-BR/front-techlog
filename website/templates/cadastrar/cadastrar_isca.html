{% extends 'bases/modal_base.html' %}

{% block modal_header %}
    
    <h5 class="modal-title" id="cadastro_isca_label">Cadastrar Isca</h5>
    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>

{% endblock %}

{% block modal_body %}
      
    <div class="modal-body form-group py-3" id="{{modal}}_{{controller}}_body">
        {% csrf_token %}

        <article id="modal-qrcode" style="display:none;">
            <div id="modal-qrcode-container">
                <button type="button" class="btn-close btn-close-white" onclick="fechar_video()"></button>
                <div id="container-video">
                    <video id="video-codebar" autoplay></video>
                    <span id="erro-video-mensagem">Posicione e Aproxime o QRcode </span>   
                </div>            
            </div>
        </article>

        <div class="mt-3 px-3 row">
            <canvas id="canvas-foto" style="display:none;"></canvas>
            <button type="button" class="btn btn-light mb-2" onclick="abrir_camera()">
                <i class="fa-solid fa-qrcode"></i><span class="ms-2">Ler QRcode</span>
            </button>           
            <span id="erro_msg" style="color: red!important; display: none;text-align:center;">Camera não disponivel no dispositivo</span>   
        </div>
        
        <div class="alert alert-danger" id="cadastrar-error-iscas-generico" style="display:none;" role="alert">
            <span id="cadastrar-error-iscas-generico-text"></span>
        </div>

        <div class="mt-3">
            <label for="numero_isca">Numero Isca</label><small style="color:red;">*</small>
            <input type="text" name="numero_isca" id="cadastrar-iscas-numero_isca" class="form-control" placeholder="digite o numero da isca">    
            <span class="cadastrar-error-iscas text-danger" id="cadastrar-error-iscas-numero_isca"></span>          
        </div>        

        <div class="mt-3">
            <label for="local_cliente">Local</label><small style="color:red;">*</small>
            <select name="local_cliente" class="form-control" id="cadastrar-iscas-local_cliente">
                <option value="">selecione uma opção</option>
                {% for local_cliente in context_locais_clientes %}
                    <option value="{{local_cliente.id}}">{{ local_cliente.local.nome }} - {{ local_cliente.cliente.nome_fantasia }}</option>
                {% endfor %}
            </select>  
            <span class="cadastrar-error-iscas text-danger" id="cadastrar-error-iscas-local_cliente"></span>    
        </div>
       
        <div class="mt-3">
            <label for="fornecedor">Fornecedores</label><small style="color:red;">*</small>
            <select name="fornecedor" class="form-control" id="cadastrar-iscas-fornecedor">
                <option value="">selecione uma opção</option>
                {% for fornecedor in context_fornecedores %}
                    <option value="{{fornecedor.id}}">{{ fornecedor.nome }}</option>
                {% endfor %}
            </select>
            <span class="cadastrar-error-iscas text-danger" id="cadastrar-error-iscas-fornecedor"></span>
        </div>

        <div class="mt-3">
            <label for="comunicacao">Comunicação</label><small style="color:red;">*</small>
            <select name="comunicacao" class="form-control" id="cadastrar-iscas-comunicacao">
                <option value="">selecione uma opção</option>
                {% for comunicacao in context_comunicacoes %}
                    <option value="{{comunicacao}}">{{ comunicacao }}</option>
                {% endfor %}
            </select>
            <span class="cadastrar-error-iscas text-danger" id="cadastrar-error-iscas-comunicacao"></span>    
        </div>

        <div class="mt-3">
            <label for="modelo">Modelo</label><small style="color:red;">*</small>
            <select name="modelo" class="form-control " id="cadastrar-iscas-modelo">
                <option value="">selecione uma opção</option>
                {% for modelo in context_modelos %}
                    <option value="{{modelo}}">{{ modelo }}</option>
                {% endfor %}
            </select>
            <span class="cadastrar-error-iscas text-danger" id="cadastrar-error-iscas-modelo"></span>    
        </div>
    
        <div class="my-3">
            <label for="operacao">Operação</label><small style="color:red;">*</small>
            <select name="operacao" class="form-control"  id="cadastrar-iscas-operacao" required>
                <option value="">selecione uma opção</option>
                {% for operacao in context_operacoes %}
                    <option value="{{operacao.id}}">{{ operacao.cliente.razao_social }} - {{ operacao.nome }}</option>
                {% endfor %}
            </select>
            <span class="cadastrar-error-iscas text-danger" id="cadastrar-error-iscas-operacao"></span>    
        </div>
    </div>

    <div class="modal-footer">
        <button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">Cancelar</button>
        <button type="button" class="btn btn-primary" onclick="cadastrar_iscas()">Cadastrar</button>
    </div>

{% endblock %}
